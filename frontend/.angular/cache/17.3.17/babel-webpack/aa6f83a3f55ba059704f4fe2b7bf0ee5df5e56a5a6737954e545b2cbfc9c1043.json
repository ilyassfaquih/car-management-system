{"ast":null,"code":"import { tap } from 'rxjs';\nimport { environment } from '../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let AuthService = /*#__PURE__*/(() => {\n  class AuthService {\n    constructor(http) {\n      this.http = http;\n      this.apiUrl = `${environment.apiUrl}/auth`;\n    }\n    login(credentials) {\n      return this.http.post(`${this.apiUrl}/login`, credentials).pipe(tap(response => {\n        localStorage.setItem('token', response.token);\n        localStorage.setItem('userId', response.userId);\n        localStorage.setItem('username', response.username);\n      }));\n    }\n    logout() {\n      localStorage.removeItem('token');\n      localStorage.removeItem('userId');\n      localStorage.removeItem('username');\n    }\n    getToken() {\n      return localStorage.getItem('token');\n    }\n    isAuthenticated() {\n      return !!this.getToken();\n    }\n    getUserId() {\n      return localStorage.getItem('userId');\n    }\n    isAdmin() {\n      const token = this.getToken();\n      if (!token) return false;\n      try {\n        // Decode JWT payload (bla librairie)\n        const payload = JSON.parse(atob(token.split('.')[1]));\n        const roles = payload.roles || [];\n        return roles.includes('ADMIN');\n      } catch (e) {\n        return false;\n      }\n    }\n    static {\n      this.ɵfac = function AuthService_Factory(t) {\n        return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: AuthService,\n        factory: AuthService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return AuthService;\n})();","map":{"version":3,"names":["tap","environment","AuthService","constructor","http","apiUrl","login","credentials","post","pipe","response","localStorage","setItem","token","userId","username","logout","removeItem","getToken","getItem","isAuthenticated","getUserId","isAdmin","payload","JSON","parse","atob","split","roles","includes","e","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\ILYAS\\Documents\\GitHub\\car-management-system\\frontend\\src\\app\\services\\auth.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, tap } from 'rxjs';\nimport { environment } from '../../environments/environment';\n\ninterface LoginResponse {\n  token: string;\n  userId: string;\n  username: string;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuthService {\n  private apiUrl = `${environment.apiUrl}/auth`;\n\n  constructor(private http: HttpClient) { }\n\n  login(credentials: { email: string; password: string }): Observable<LoginResponse> {\n    return this.http.post<LoginResponse>(`${this.apiUrl}/login`, credentials).pipe(\n      tap(response => {\n        localStorage.setItem('token', response.token);\n        localStorage.setItem('userId', response.userId);\n        localStorage.setItem('username', response.username);\n      })\n    );\n  }\n\n  logout(): void {\n    localStorage.removeItem('token');\n    localStorage.removeItem('userId');\n    localStorage.removeItem('username');\n  }\n\n  getToken(): string | null {\n    return localStorage.getItem('token');\n  }\n\n  isAuthenticated(): boolean {\n    return !!this.getToken();\n  }\n\n  getUserId(): string | null {\n    return localStorage.getItem('userId');\n  }\n  isAdmin(): boolean {\n    const token = this.getToken();\n    if (!token) return false;\n\n    try {\n      // Decode JWT payload (bla librairie)\n      const payload = JSON.parse(atob(token.split('.')[1]));\n      const roles = payload.roles || [];\n      return roles.includes('ADMIN');\n    } catch (e) {\n      return false;\n    }\n  }\n}\n"],"mappings":"AAEA,SAAqBA,GAAG,QAAQ,MAAM;AACtC,SAASC,WAAW,QAAQ,gCAAgC;;;AAW5D,WAAaC,WAAW;EAAlB,MAAOA,WAAW;IAGtBC,YAAoBC,IAAgB;MAAhB,KAAAA,IAAI,GAAJA,IAAI;MAFhB,KAAAC,MAAM,GAAG,GAAGJ,WAAW,CAACI,MAAM,OAAO;IAEL;IAExCC,KAAKA,CAACC,WAAgD;MACpD,OAAO,IAAI,CAACH,IAAI,CAACI,IAAI,CAAgB,GAAG,IAAI,CAACH,MAAM,QAAQ,EAAEE,WAAW,CAAC,CAACE,IAAI,CAC5ET,GAAG,CAACU,QAAQ,IAAG;QACbC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEF,QAAQ,CAACG,KAAK,CAAC;QAC7CF,YAAY,CAACC,OAAO,CAAC,QAAQ,EAAEF,QAAQ,CAACI,MAAM,CAAC;QAC/CH,YAAY,CAACC,OAAO,CAAC,UAAU,EAAEF,QAAQ,CAACK,QAAQ,CAAC;MACrD,CAAC,CAAC,CACH;IACH;IAEAC,MAAMA,CAAA;MACJL,YAAY,CAACM,UAAU,CAAC,OAAO,CAAC;MAChCN,YAAY,CAACM,UAAU,CAAC,QAAQ,CAAC;MACjCN,YAAY,CAACM,UAAU,CAAC,UAAU,CAAC;IACrC;IAEAC,QAAQA,CAAA;MACN,OAAOP,YAAY,CAACQ,OAAO,CAAC,OAAO,CAAC;IACtC;IAEAC,eAAeA,CAAA;MACb,OAAO,CAAC,CAAC,IAAI,CAACF,QAAQ,EAAE;IAC1B;IAEAG,SAASA,CAAA;MACP,OAAOV,YAAY,CAACQ,OAAO,CAAC,QAAQ,CAAC;IACvC;IACAG,OAAOA,CAAA;MACL,MAAMT,KAAK,GAAG,IAAI,CAACK,QAAQ,EAAE;MAC7B,IAAI,CAACL,KAAK,EAAE,OAAO,KAAK;MAExB,IAAI;QACF;QACA,MAAMU,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACb,KAAK,CAACc,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACrD,MAAMC,KAAK,GAAGL,OAAO,CAACK,KAAK,IAAI,EAAE;QACjC,OAAOA,KAAK,CAACC,QAAQ,CAAC,OAAO,CAAC;OAC/B,CAAC,OAAOC,CAAC,EAAE;QACV,OAAO,KAAK;;IAEhB;;;yBA5CW5B,WAAW,EAAA6B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;MAAA;IAAA;;;eAAXhC,WAAW;QAAAiC,OAAA,EAAXjC,WAAW,CAAAkC,IAAA;QAAAC,UAAA,EAFV;MAAM;IAAA;;SAEPnC,WAAW;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}